<!DOCTYPE HTML><html><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<title>C++类对象的复制－拷贝构造函数</title>
    <!--mark |wiz_custom_css| for wizeditor replace it-->
<style id="wiz_custom_css">html, body {            font-size: 15px;        }        body {            font-family: Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;            line-height: 1.6;            margin: 0;            padding: 20px 15px;            padding: 1.33rem 1rem;        }        h1, h2, h3, h4, h5, h6 {            margin: 20px 0 10px;            margin: 1.33rem 0 0.667rem;            padding: 0;            font-weight: bold;        }        h1 {            font-size: 21px;            font-size: 1.4rem;        }        h2 {            font-size: 20px;            font-size: 1.33rem;        }        h3 {            font-size: 18px;            font-size: 1.2rem;        }        h4 {            font-size: 17px;            font-size: 1.13rem;        }        h5 {            font-size: 15px;            font-size: 1rem;        }        h6 {            font-size: 15px;            font-size: 1rem;            color: #777777;            margin: 1rem 0;        }        div, p, ul, ol, dl, li {            margin: 0;        }        blockquote, table, pre, code {            margin: 8px 0;        }        ul, ol {            padding-left: 32px;            padding-left: 2.13rem;        }        blockquote {            padding: 0 12px;            padding: 0 0.8rem;        }        blockquote > :first-child {            margin-top: 0;        }        blockquote > :last-child {            margin-bottom: 0;        }        img {            border: 0;            max-width: 100%;            height: auto !important;            margin: 2px 0;        }        table {            border-collapse: collapse;            border: 1px solid #bbbbbb;        }        td, th {            padding: 4px 8px;            border-collapse: collapse;            border: 1px solid #bbbbbb;			        }        @media only screen and (-webkit-max-device-width: 1024px), only screen and (-o-max-device-width: 1024px), only screen and (max-device-width: 1024px), only screen and (-webkit-min-device-pixel-ratio: 3), only screen and (-o-min-device-pixel-ratio: 3), only screen and (min-device-pixel-ratio: 3) {            html, body {                font-size: 17px;            }            body {                line-height: 1.7;                padding: 0.75rem 0.9375rem;                color: #353c47;            }            h1 {                font-size: 2.125rem;            }            h2 {                font-size: 1.875rem;            }            h3 {                font-size: 1.625rem;            }            h4 {                font-size: 1.375rem;            }            h5 {                font-size: 1.125rem;            }            h6 {                color: inherit;            }            ul, ol {                padding-left: 2.5rem;            }            blockquote {                padding: 0 0.9375rem;            }        }</style><link rel="stylesheet"  name="wiz_tmp_editor_style" href="C++类对象的复制－拷贝构造函数_files/fonts_83.css"></head>

<body spellcheck="false" ><p style="padding: 0px; margin-top: 18px; margin-bottom: 18px; line-height: 26px; height: auto; font-size: 14px; overflow: visible; color: rgb(51, 51, 51); font-family: 宋体, simsun, tahoma; background-color: rgb(255, 255, 255);">　在学习这一章内容前我们已经学习过了类的构造函数和析构函数的相关知识，对于普通类型的对象来说，他们之间的复制是很简单的，例如：</p><p class="code" style="padding: 0px; margin-top: 18px; margin-bottom: 18px; line-height: 26px; height: auto; font-size: 14px; overflow: visible; color: rgb(51, 51, 51); font-family: 宋体, simsun, tahoma; background-color: rgb(255, 255, 255);">int a = 10;&nbsp;<br>int b =a;</p><p style="padding: 0px; margin-top: 18px; margin-bottom: 18px; line-height: 26px; height: auto; font-size: 14px; overflow: visible; color: rgb(51, 51, 51); font-family: 宋体, simsun, tahoma; background-color: rgb(255, 255, 255);">　　自己定义的类的对象同样是对象，谁也不能阻止我们用以下的方式进行复制,例如：</p><p class="code" clear="both" style="padding: 0px; margin-top: 18px; margin-bottom: 18px; line-height: 26px; height: auto; font-size: 14px; overflow: visible; color: rgb(51, 51, 51); font-family: 宋体, simsun, tahoma; background-color: rgb(255, 255, 255);">#include&nbsp;&lt;<font color="maroon">iostream</font>&gt;&nbsp;&nbsp;<br><font color="blue">using</font>&nbsp;<font color="blue">namespace</font>&nbsp;std;&nbsp;&nbsp;<br>&nbsp;&nbsp;<br><font color="blue">class</font>&nbsp;Test&nbsp;&nbsp;<br>{&nbsp;&nbsp;<br><font color="blue">public</font>:&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;Test(<font color="blue">int</font>&nbsp;temp)&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p1=temp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;<br><font color="blue">protected</font>:&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue">int</font>&nbsp;p1;&nbsp;&nbsp;<br>&nbsp;&nbsp;<br>};&nbsp;&nbsp;<br>&nbsp;&nbsp;<br><font color="blue">void</font>&nbsp;<font color="blue">main</font>()&nbsp;&nbsp;<br>{&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;Test&nbsp;a(99);&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;Test&nbsp;b=a;&nbsp;&nbsp;<br>}</p><p style="padding: 0px; margin-top: 18px; margin-bottom: 18px; line-height: 26px; height: auto; font-size: 14px; overflow: visible; color: rgb(51, 51, 51); font-family: 宋体, simsun, tahoma; background-color: rgb(255, 255, 255);">　　普通对象和类对象同为对象，他们之间的特性有相似之处也有不同之处，类对象内部存在成员变量，而普通对象是没有的，当同样的复制方法发生在不同的对象上的时候，那么系统对他们进行的操作也是不一样的，就类对象而言，相同类型的类对象是通过<b><font color="#ff0000">拷贝构造函数</font></b>来完成整个复制过程的，在上面的代码中,我们并没有看到拷贝构造函数，同样完成了复制工作，这又是为什么呢？因为当一个类没有自定义的拷贝构造函数的时候系统会自动提供一个<font color="#ff0000"><b>默认的拷贝构造函数</b></font>，来完成复制工作。&nbsp;<br><br>　　下面，我们为了说明情况，就普通情况而言(以上面的代码为例)，我们来自己定义一个与系统默认拷贝构造函数一样的拷贝构造函数，看看它的内部是如何工作的！&nbsp;<br><br>　　代码如下：</p><p class="code" style="padding: 0px; margin-top: 18px; margin-bottom: 18px; line-height: 26px; height: auto; font-size: 14px; overflow: visible; color: rgb(51, 51, 51); font-family: 宋体, simsun, tahoma; background-color: rgb(255, 255, 255);">#include&nbsp;&lt;<font color="maroon">iostream</font>&gt;&nbsp;&nbsp;<br><font color="blue">using</font>&nbsp;<font color="blue">namespace</font>&nbsp;std;&nbsp;&nbsp;<br>&nbsp;&nbsp;<br><font color="blue">class</font>&nbsp;Test&nbsp;&nbsp;<br>{&nbsp;&nbsp;<br><font color="blue">public</font>:&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;Test(<font color="blue">int</font>&nbsp;temp)&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p1=temp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;Test(Test&nbsp;&amp;c_t)<font color="green">//这里就是自定义的拷贝构造函数&nbsp;</font>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="maroon">cout</font>&lt;&lt;"进入copy构造函数"&lt;&lt;endl;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p1=c_t.p1;<font color="green">//这句如果去掉就不能完成复制工作了,此句复制过程的核心语句&nbsp;</font>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;<br><font color="blue">public</font>:&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue">int</font>&nbsp;p1;&nbsp;&nbsp;<br>};&nbsp;&nbsp;<br>&nbsp;&nbsp;<br><font color="blue">void</font>&nbsp;<font color="blue">main</font>()&nbsp;&nbsp;<br>{&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;Test&nbsp;a(99);&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;Test&nbsp;b=a;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="maroon">cout</font>&lt;&lt;b.p1;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="maroon">cin</font>.get();&nbsp;&nbsp;<br>}</p><p style="padding: 0px; margin-top: 18px; margin-bottom: 18px; line-height: 26px; height: auto; font-size: 14px; overflow: visible; color: rgb(51, 51, 51); font-family: 宋体, simsun, tahoma; background-color: rgb(255, 255, 255);">　　上面代码中的Test(Test &amp;c_t)就是我们自定义的拷贝构造函数，拷贝构造函数的名称必须与类名称一致，函数的形式参数是本类型的一个引用变量,<b>且<font color="#ff0000">必须</font>是引用</b>。&nbsp;<br><br><b>　　当用一个已经初始化过了的自定义类类型对象去初始化另一个新构造的对象的时候，拷贝构造函数就会被<font color="#ffffff" style="background-color: rgb(176, 0, 176);">自动调用</font></b>，如果你没有自定义拷贝构造函数的时候系统将会提供给一个默认的拷贝构造函数来完成这个过程，上面代码的复制核心语句就是通过Test(Test &amp;c_t)拷贝构造函数内的p1=c_t.p1;语句完成的。如果取掉这句代码，那么b对象的p1属性将得到一个未知的随机值；</p><div class="pageNumber" style="border-top-width: 1px; border-top-style: dashed; border-top-color: rgb(203, 203, 203); padding: 10px 15px 0px; margin-top: 10px; line-height: 23px; height: 23px; overflow: hidden; color: rgb(51, 51, 51); font-family: 宋体, simsun, tahoma; font-size: 12px; background-color: rgb(255, 255, 255);"><span class="sNum" style="padding: 0px 5px; color: rgb(255, 255, 255); font-size: 14px; font-weight: 700; float: left; background: rgb(27, 71, 152);">2</span><span class="sTit" style="height: 23px; display: block; overflow: hidden; word-break: break-all; word-wrap: break-word; width: 440px; color: rgb(0, 51, 136); font-size: 16px; font-weight: 700; padding-left: 12px; float: left;"></span><span class="sTop" style="padding-left: 12px; float: right;"><a href="http://pcedu.pconline.com.cn/empolder/gj/c/0503/570112_all.html#article_brief" name="content_page_2" target="_self" style="color: rgb(119, 119, 119); text-decoration: none; padding-left: 14px; white-space: nowrap; background: url(&quot;C++类对象的复制－拷贝构造函数_files/art_bg.png&quot;) -84px -24px no-repeat;">回顶部</a></span></div><p style="padding: 0px; margin-top: 18px; margin-bottom: 18px; line-height: 26px; height: auto; font-size: 14px; overflow: visible; color: rgb(51, 51, 51); font-family: 宋体, simsun, tahoma; background-color: rgb(255, 255, 255);">　　下面我们来讨论一下关于浅拷贝和深拷贝的问题。&nbsp;<br><br>　　就上面的代码情况而言，很多人会问到，既然系统会自动提供一个默认的拷贝构造函数来处理复制，那么我们没有意义要去自定义拷贝构造函数呀，对，就普通情况而言这的确是没有必要的，但在某写状况下，类体内的成员是需要开辟动态开辟堆内存的,如果我们不自定义拷贝构造函数而让系统自己处理，那么就会导致堆内存的所属权产生混乱，试想一下，已经开辟的一端堆地址原来是属于对象a的，由于复制过程发生，b对象取得是a已经开辟的堆地址，一旦程序产生析构，释放堆的时候，计算机是不可能清楚这段地址是真正属于谁的，当连续发生两次析构的时候就出现了运行错误。&nbsp;<br><br>　　为了更详细的说明问题，请看如下的代码。</p><p class="code" style="padding: 0px; margin-top: 18px; margin-bottom: 18px; line-height: 26px; height: auto; font-size: 14px; overflow: visible; color: rgb(51, 51, 51); font-family: 宋体, simsun, tahoma; background-color: rgb(255, 255, 255);">#include&nbsp;&lt;<font color="maroon">iostream</font>&gt;&nbsp;&nbsp;<br><font color="blue">using</font>&nbsp;<font color="blue">namespace</font>&nbsp;std;&nbsp;&nbsp;<br>&nbsp;&nbsp;<br><font color="blue">class</font>&nbsp;Internet&nbsp;&nbsp;<br>{&nbsp;&nbsp;<br><font color="blue">public</font>:&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;Internet(<font color="blue">char</font>&nbsp;*name,<font color="blue">char</font>&nbsp;*address)&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="maroon">cout</font>&lt;&lt;"载入构造函数"&lt;&lt;endl;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strcpy(Internet::name,name);&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strcpy(Internet::address,address);&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cname=<font color="blue">new</font>&nbsp;<font color="blue">char</font>[strlen(name)+1];&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue">if</font>(cname!=NULL)&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strcpy(Internet::cname,name);&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;Internet(Internet&nbsp;&amp;temp)&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="maroon">cout</font>&lt;&lt;"载入COPY构造函数"&lt;&lt;endl;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strcpy(Internet::name,temp.name);&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strcpy(Internet::address,temp.address);&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cname=<font color="blue">new</font>&nbsp;<font color="blue">char</font>[strlen(name)+1];<font color="green">//这里注意,深拷贝的体现!&nbsp;</font>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue">if</font>(cname!=NULL)&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strcpy(Internet::cname,name);&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;~Internet()&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="maroon">cout</font>&lt;&lt;"载入析构函数!";&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue">delete</font>[]&nbsp;cname;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="maroon">cin</font>.get();&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue">void</font>&nbsp;show();&nbsp;&nbsp;<br><font color="blue">protected</font>:&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue">char</font>&nbsp;name[20];&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue">char</font>&nbsp;address[30];&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue">char</font>&nbsp;*cname;&nbsp;&nbsp;<br>};&nbsp;&nbsp;<br><font color="blue">void</font>&nbsp;Internet::show()&nbsp;&nbsp;<br>{&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="maroon">cout</font>&lt;&lt;name&lt;&lt;":"&lt;&lt;address&lt;&lt;cname&lt;&lt;endl;&nbsp;&nbsp;<br>}&nbsp;&nbsp;<br><font color="blue">void</font>&nbsp;test(Internet&nbsp;ts)&nbsp;&nbsp;<br>{&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="maroon">cout</font>&lt;&lt;"载入test函数"&lt;&lt;endl;&nbsp;&nbsp;<br>}&nbsp;&nbsp;<br><font color="blue">void</font>&nbsp;<font color="blue">main</font>()&nbsp;&nbsp;<br>{&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;Internet&nbsp;a("中国软件开发实验室","www.cndev-lab.com");&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;Internet&nbsp;b&nbsp;<font color="red">=</font>&nbsp;a;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;b.show();&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;test(b);&nbsp;&nbsp;<br>}</p><p style="padding: 0px; margin-top: 18px; margin-bottom: 18px; line-height: 26px; height: auto; font-size: 14px; overflow: visible; color: rgb(51, 51, 51); font-family: 宋体, simsun, tahoma; background-color: rgb(255, 255, 255);">　　上面代码就演示了深拷贝的问题,对对象b的cname属性采取了新开辟内存的方式避免了内存归属不清所导致析构释放空间时候的错误,最后我必须提一下，对于上面的程序我的解释并不多，就是希望读者本身运行程序观察变化，进而深刻理解。</p><p style="padding: 0px; margin-top: 18px; margin-bottom: 18px; line-height: 26px; height: auto; font-size: 14px; overflow: visible; color: rgb(51, 51, 51); font-family: 宋体, simsun, tahoma; background-color: rgb(255, 255, 255);">　　<font color="#ffffff" style="background-color: rgb(176, 0, 176);">拷贝和浅拷贝的定义可以简单理解成：</font>如果一个类拥有资源(堆，或者是其它系统资源)，当这个类的对象发生复制过程的时候，这个过程就可以叫做<font color="#ff0000"><b>深拷贝</b></font>，反之对象存在资源但复制过程并未复制资源的情况视为<b><font color="#ff0000">浅拷贝</font></b>。&nbsp;<br><br><br>　　浅拷贝资源后在释放资源的时候会产生资源归属不清的情况导致程序运行出错,这点尤其需要注意！</p><p style="padding: 0px; margin-top: 18px; margin-bottom: 18px; line-height: 26px; height: auto; font-size: 14px; overflow: visible; color: rgb(51, 51, 51); font-family: 宋体, simsun, tahoma; background-color: rgb(255, 255, 255);">　　以前我们的教程中讨论过函数返回对象产生临时变量的问题，接下来我们来看一下<b>在函数中返回<font color="#ff0000">自定义类型</font>对象</b>是否也遵循此规则<font color="#ffffff" style="background-color: rgb(176, 0, 176);">产生临时对象</font>！&nbsp;<br><br></p><div class="pageNumber" style="border-top-width: 1px; border-top-style: dashed; border-top-color: rgb(203, 203, 203); padding: 10px 15px 0px; margin-top: 10px; line-height: 23px; height: 23px; overflow: hidden; color: rgb(51, 51, 51); font-family: 宋体, simsun, tahoma; font-size: 12px; background-color: rgb(255, 255, 255);"><span class="sNum" style="padding: 0px 5px; color: rgb(255, 255, 255); font-size: 14px; font-weight: 700; float: left; background: rgb(27, 71, 152);">3</span><span class="sTit" style="height: 23px; display: block; overflow: hidden; word-break: break-all; word-wrap: break-word; width: 440px; color: rgb(0, 51, 136); font-size: 16px; font-weight: 700; padding-left: 12px; float: left;"></span><span class="sTop" style="padding-left: 12px; float: right;"><a href="http://pcedu.pconline.com.cn/empolder/gj/c/0503/570112_all.html#article_brief" name="content_page_3" target="_self" style="color: rgb(119, 119, 119); text-decoration: none; padding-left: 14px; white-space: nowrap; background: url(&quot;C++类对象的复制－拷贝构造函数_files/art_bg.png&quot;) -84px -24px no-repeat;">回顶部</a></span></div><span style="color: rgb(51, 51, 51); font-family: 宋体, simsun, tahoma; font-size: 12px; line-height: 26px; background-color: rgb(255, 255, 255);">　　先运行下列代码：</span><p style="padding: 0px; margin-top: 18px; margin-bottom: 18px; line-height: 26px; height: auto; font-size: 14px; overflow: visible; color: rgb(51, 51, 51); font-family: 宋体, simsun, tahoma; background-color: rgb(255, 255, 255);"></p><p class="code" style="padding: 0px; margin-top: 18px; margin-bottom: 18px; line-height: 26px; height: auto; font-size: 14px; overflow: visible; color: rgb(51, 51, 51); font-family: 宋体, simsun, tahoma; background-color: rgb(255, 255, 255);">#include&nbsp;&lt;<font color="maroon">iostream</font>&gt;&nbsp;&nbsp;<br><font color="blue">using</font>&nbsp;<font color="blue">namespace</font>&nbsp;std;&nbsp;&nbsp;<br>&nbsp;&nbsp;<br><font color="blue">class</font>&nbsp;Internet&nbsp;&nbsp;<br>{&nbsp;&nbsp;<br><font color="blue">public</font>:&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;Internet()&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;};&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;Internet(<font color="blue">char</font>&nbsp;*name,<font color="blue">char</font>&nbsp;*address)&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="maroon">cout</font>&lt;&lt;"载入构造函数"&lt;&lt;endl;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strcpy(Internet::name,name);&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;Internet(Internet&nbsp;&amp;temp)&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="maroon">cout</font>&lt;&lt;"载入COPY构造函数"&lt;&lt;endl;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strcpy(Internet::name,temp.name);&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="maroon">cin</font>.get();&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;~Internet()&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="maroon">cout</font>&lt;&lt;"载入析构函数!";&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="maroon">cin</font>.get();&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;<br><font color="blue">protected</font>:&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue">char</font>&nbsp;name[20];&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue">char</font>&nbsp;address[20];&nbsp;&nbsp;<br>};&nbsp;&nbsp;<br>Internet&nbsp;tp()&nbsp;&nbsp;<br>{&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;Internet&nbsp;b("中国软件开发实验室","www.cndev-lab.com");&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue">return</font>&nbsp;b;&nbsp;&nbsp;<br>}&nbsp;&nbsp;<br><font color="blue">void</font>&nbsp;<font color="blue">main</font>()&nbsp;&nbsp;<br>{&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;Internet&nbsp;a;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;a=tp();&nbsp;&nbsp;<br>}</p><p style="padding: 0px; margin-top: 18px; margin-bottom: 18px; line-height: 26px; height: auto; font-size: 14px; overflow: visible; color: rgb(51, 51, 51); font-family: 宋体, simsun, tahoma; background-color: rgb(255, 255, 255);">　　从上面的代码运行结果可以看出，程序一共载入过析构函数三次，证明了由函数返回自定义类型对象同样会产生临时变量，事实上对象a得到的就是这个临时Internet类类型对象temp的值。</p><p style="padding: 0px; margin-top: 18px; margin-bottom: 18px; line-height: 26px; height: auto; font-size: 14px; overflow: visible; color: rgb(51, 51, 51); font-family: 宋体, simsun, tahoma; background-color: rgb(255, 255, 255);">　　这一下节的内容我们来说一下<font color="#ff0000"><b>无名对象</b></font>。</p><p style="padding: 0px; margin-top: 18px; margin-bottom: 18px; line-height: 26px; height: auto; font-size: 14px; overflow: visible; color: rgb(51, 51, 51); font-family: 宋体, simsun, tahoma; background-color: rgb(255, 255, 255);">　　<font color="#ffffff" style="background-color: rgb(176, 0, 176);">利用无名对象初始化对象系统不会不调用拷贝构造函数。</font>&nbsp;<br><br>　　那么什么又是无名对象呢？&nbsp;<br><br>　　很简单，如果在上面程序的main函数中有：&nbsp;<br><br>　　Internet　("中国软件开发实验室","www.cndev-lab.com");&nbsp;<br><br>　　这样的一句语句就会产生一个无名对象，无名对象会调用构造函数但利用无名对象初始化对象系统不会不调用拷贝构造函数！&nbsp;<br><br>　　下面三段代码是很见到的三种利用无名对象初始化对象的例子。</p><p class="code" style="padding: 0px; margin-top: 18px; margin-bottom: 18px; line-height: 26px; height: auto; font-size: 14px; overflow: visible; color: rgb(51, 51, 51); font-family: 宋体, simsun, tahoma; background-color: rgb(255, 255, 255);">#include&nbsp;&lt;<font color="maroon">iostream</font>&gt;&nbsp;&nbsp;<br><font color="blue">using</font>&nbsp;<font color="blue">namespace</font>&nbsp;std;&nbsp;&nbsp;<br>&nbsp;&nbsp;<br><font color="blue">class</font>&nbsp;Internet&nbsp;&nbsp;<br>{&nbsp;&nbsp;<br><font color="blue">public</font>:&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;Internet(<font color="blue">char</font>&nbsp;*name,<font color="blue">char</font>&nbsp;*address)&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="maroon">cout</font>&lt;&lt;"载入构造函数"&lt;&lt;endl;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strcpy(Internet::name,name);&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;Internet(Internet&nbsp;&amp;temp)&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="maroon">cout</font>&lt;&lt;"载入COPY构造函数"&lt;&lt;endl;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strcpy(Internet::name,temp.name);&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="maroon">cin</font>.get();&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;~Internet()&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="maroon">cout</font>&lt;&lt;"载入析构函数!";&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;<br><font color="blue">public</font>:&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue">char</font>&nbsp;name[20];&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue">char</font>&nbsp;address[20];&nbsp;&nbsp;<br>};&nbsp;&nbsp;<br>&nbsp;&nbsp;<br><font color="blue">void</font>&nbsp;<font color="blue">main</font>()&nbsp;&nbsp;<br>{&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;Internet&nbsp;a=Internet("中国软件开发实验室","www.cndev-lab.com");&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="maroon">cout</font>&lt;&lt;a.name;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="maroon">cin</font>.get();&nbsp;&nbsp;<br>}</p><p style="padding: 0px; margin-top: 18px; margin-bottom: 18px; line-height: 26px; height: auto; font-size: 14px; overflow: visible; color: rgb(51, 51, 51); font-family: 宋体, simsun, tahoma; background-color: rgb(255, 255, 255);">　　上面代码的运行结果有点“出人意料”，从思维逻辑上说，当无名对象创建了后，是应该调用自定义拷贝构造函数，或者是默认拷贝构造函数来完成复制过程的，但事实上系统并没有这么做，因为无名对象使用过后在整个程序中就失去了作用，对于这种情况c++会把代码看成是：</p><p style="padding: 0px; margin-top: 18px; margin-bottom: 18px; line-height: 26px; height: auto; font-size: 14px; overflow: visible; color: rgb(51, 51, 51); font-family: 宋体, simsun, tahoma; background-color: rgb(255, 255, 255);">Internet a("中国软件开发实验室",www.cndev-lab.com);</p><p style="padding: 0px; margin-top: 18px; margin-bottom: 18px; line-height: 26px; height: auto; font-size: 14px; overflow: visible; color: rgb(51, 51, 51); font-family: 宋体, simsun, tahoma; background-color: rgb(255, 255, 255);">　　省略了创建无名对象这一过程，所以说不会调用拷贝构造函数。</p><div class="pageNumber" style="border-top-width: 1px; border-top-style: dashed; border-top-color: rgb(203, 203, 203); padding: 10px 15px 0px; margin-top: 10px; line-height: 23px; height: 23px; overflow: hidden; color: rgb(51, 51, 51); font-family: 宋体, simsun, tahoma; font-size: 12px; background-color: rgb(255, 255, 255);"><span class="sNum" style="padding: 0px 5px; color: rgb(255, 255, 255); font-size: 14px; font-weight: 700; float: left; background: rgb(27, 71, 152);">4</span><span class="sTit" style="height: 23px; display: block; overflow: hidden; word-break: break-all; word-wrap: break-word; width: 440px; color: rgb(0, 51, 136); font-size: 16px; font-weight: 700; padding-left: 12px; float: left;"></span><span class="sTop" style="padding-left: 12px; float: right;"><a href="http://pcedu.pconline.com.cn/empolder/gj/c/0503/570112_all.html#article_brief" name="content_page_4" target="_self" style="color: rgb(119, 119, 119); text-decoration: none; padding-left: 14px; white-space: nowrap; background: url(&quot;C++类对象的复制－拷贝构造函数_files/art_bg.png&quot;) -84px -24px no-repeat;">回顶部</a></span></div><p style="padding: 0px; margin-top: 18px; margin-bottom: 18px; line-height: 26px; height: auto; font-size: 14px; overflow: visible; color: rgb(51, 51, 51); font-family: 宋体, simsun, tahoma; background-color: rgb(255, 255, 255);">　　最后让我们来看看引用无名对象的情况。</p><p class="code" style="padding: 0px; margin-top: 18px; margin-bottom: 18px; line-height: 26px; height: auto; font-size: 14px; overflow: visible; color: rgb(51, 51, 51); font-family: 宋体, simsun, tahoma; background-color: rgb(255, 255, 255);">#include&nbsp;&lt;<font color="maroon">iostream</font>&gt;&nbsp;&nbsp;&nbsp;&nbsp;<br><font color="blue">using</font>&nbsp;<font color="blue">namespace</font>&nbsp;std;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<br><font color="blue">class</font>&nbsp;Internet&nbsp;&nbsp;&nbsp;&nbsp;<br>{&nbsp;&nbsp;&nbsp;&nbsp;<br><font color="blue">public</font>:&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;Internet(<font color="blue">char</font>&nbsp;*name,<font color="blue">char</font>&nbsp;*address)&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="maroon">cout</font>&lt;&lt;"载入构造函数"&lt;&lt;endl;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strcpy(Internet::name,name);&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;Internet(Internet&nbsp;&amp;temp)&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="maroon">cout</font>&lt;&lt;"载入COPY构造函数"&lt;&lt;endl;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strcpy(Internet::name,temp.name);&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="maroon">cin</font>.get();&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;~Internet()&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="maroon">cout</font>&lt;&lt;"载入析构函数!";&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;<br><font color="blue">public</font>:&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue">char</font>&nbsp;name[20];&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue">char</font>&nbsp;address[20];&nbsp;&nbsp;&nbsp;&nbsp;<br>};&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<br><font color="blue">void</font>&nbsp;<font color="blue">main</font>()&nbsp;&nbsp;&nbsp;&nbsp;<br>{&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;Internet&nbsp;&amp;a=Internet("中国软件开发实验室","www.cndev-lab.com");&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="maroon">cout</font>&lt;&lt;a.name;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="maroon">cin</font>.get();&nbsp;&nbsp;&nbsp;&nbsp;<br>}</p><p style="padding: 0px; margin-top: 18px; margin-bottom: 18px; line-height: 26px; height: auto; font-size: 14px; overflow: visible; color: rgb(51, 51, 51); font-family: 宋体, simsun, tahoma; background-color: rgb(255, 255, 255);">　　引用本身是对象的别名，和复制并没有关系，所以不会调用拷贝构造函数,但要注意的是，在c++看来:&nbsp;<br><br>Internet &amp;a=Internet("中国软件开发实验室","www.cndev-lab.com");&nbsp;<br><br>　　是等价与:&nbsp;<br><br>Internet a("中国软件开发实验室","www.cndev-lab.com");&nbsp;<br><br>　　的,注意观察调用析构函数的位置（<font color="#ffffff" style="background-color: rgb(176, 0, 176);">这种情况是在main()外调用，而无名对象本身是在main()内析构的</font>）。</p><br><div style="color:gray"><small>来源：&nbsp;<a href="http://pcedu.pconline.com.cn/empolder/gj/c/0503/570112_all.html#content_page_2">http://pcedu.pconline.com.cn/empolder/gj/c/0503/570112_all.html#content_page_2</a></small></div></body></html>